{% extends "layout.html" %}

{% block title %}
    Sign Up
{% endblock %}

{% block main %}
  <form action="/sign_up" method="post" id="sign_up">
    <div class="form-group">
            <input autocomplete="off" autofocus class="form-control" name="username" placeholder="Username" type="text" id="username">
    </div>
    <div class="form-group">
           <input class="form-control" name="password" placeholder="Password" type="password" id="password">
    </div>
    <div class="form-group">
           <input class="form-control" name="confirmation" placeholder="Confirmation" type="password" id="confirmation">
    </div>

    <button class="btn btn-primary" type="submit" name="sign_up">Sign Up</button>
  </form>
  <script>


      document.getElementById('sign_up').addEventListener("submit", function(event)
      {
          if (!document.querySelector('#username').value || !document.querySelector('#password').value || !document.querySelector('#confirmation'))
          {
              alert('Please provide username, password and password confirmation.');
              event.preventDefault();
              return false;
          }

          else
          {   event.preventDefault();
              $.get('/check?username=' + document.querySelector('#username').value, function(data) {
                  if (!data) {
                      alert('Username already exists!');}
                  else {document.getElementById('sign_up').submit();}
              });
          }

      });

  </script>
{% endblock %}
